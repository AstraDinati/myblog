<!-- blog/templates/blog/post_list.html -->

{% extends 'blog/base.html' %}

{% block content %}
<div class="blog-flex">

    <!-- Список тегов -->
    <div class="blog-flex__aside">
        <div class="tag-container lg:p-6 shadow-md rounded lg:flex">
            <h2>Tags:</h2>
            <ul class="tag-cloud">
                {% for tag in tags %}
                <li class="tag-cloud-item">
                    <a href="{% url 'tag_filter' %}?tag={{ tag.name }}"
                        class="tag-link {% if tag.name in selected_tags %}selected-tag{% endif %}">
                        {{ tag.name }}
                    </a>
                </li>
                {% endfor %}
            </ul>
            <a href="{% url 'tag_filter' %}?{% if selected_tags %}selected_tags={{ selected_tags|join:',' }}{% endif %}"
                class="hover:bg-gray-200 hover:text-blue-500 hover:underline">
                Reset filters
            </a>
            <br>

        </div>
    </div>

    <!-- Список постов -->
    <div class="blog-flex__section">
        {% for post in posts %}
        <div class="post bg-white lg:flex lg:p-6 p-0 shadow-md mb-4 lg:mx-auto"> <!-- Уменьшил mb-4 на mb-2 -->
            <h2 class="post-title text-2xl font-bold mb-2"><a href="{% url 'post_detail' pk=post.pk %}">
                    {{ post.title }}</a>
            </h2>
            <p class="text-gray-600 mb-2">{{ post.pub_date }}</p>
            <p class="text-gray-800">{{ post.content|truncatewords:24 }}</p>
            <p>Tags: {% for tag in post.tags.all %}
                <a href="{% url 'tag_filter' %}?tag={{ tag.name }}" class="tag-link">{{ tag.name }}</a>
                {% if not forloop.last %}, {% endif %}{% endfor %}
            </p>
        </div>
        {% endfor %}
        <div class="pagination">
            {% if posts.has_previous %}
            <a href="?page=1" class="double-arrow">&laquo;</a>
            <a href="?page={{ posts.previous_page_number }}" class="arrow">&lsaquo;</a>
            {% endif %}

            {% for page in posts.paginator.page_range %}
            {% if page == posts.number %}
            <span class="current">{{ page }}</span>
            {% else %}
            <a href="?page={{ page }}">{{ page }}</a>
            {% endif %}
            {% endfor %}

            {% if posts.has_next %}
            <a href="?page={{ posts.next_page_number }}" class="arrow">&rsaquo;</a>
            <a href="?page={{ posts.paginator.num_pages }}" class="double-arrow">&raquo;</a>
            {% endif %}
        </div>

    </div>



</div>
{% endblock %}




<!-- <form action="{% url 'tag_filter' %}" method="get">
                <label for="tag">Filter by tags:</label>
                <div>
                    <input type="text" name="tag" id="tag" placeholder="Enter tags (comma-separated)">
                    <button type="submit">Filter</button>
                </div>
            </form> -->


<a href="{% url 'post_list' %}?{% if selected_tags %}selected_tags={{ selected_tags|join:',' }}{% endif %}"
    class="hover:bg-gray-200 hover:text-blue-500 hover:underline">
    Reset filters
</a>
<a href="{% url 'post_list' %}?{% if selected_tags %}selected_tags={{ selected_tags|join:',' }}{% endif %}"
    class="hover:bg-gray-200 hover:text-blue-500 hover:underline">
    Reset filters
</a>